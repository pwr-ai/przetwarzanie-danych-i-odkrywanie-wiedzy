
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laboratorium 3: Tworzenie modeli uczenia maszynowego &#8212; Przetwarzanie danych i odkrywanie wiedzy</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Laboratorium 4: Manipulacje zbiorami danych" href="lab4-manipulacja-datasetem.html" />
    <link rel="prev" title="Laboratorium 2: Podstawowe biblioteki do odkrywania wiedzy" href="lab2-podstawowe-biblioteki.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Przetwarzanie danych i odkrywanie wiedzy</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Przetwarzanie Danych i Odkrywanie Wiedzy
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Laboratoria
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="lab1-przygotowanie-srodowiska.html">
   Laboratorium 1: Wprowadzenie i przygotowanie środowiska
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab2-podstawowe-biblioteki.html">
   Laboratorium 2: Podstawowe biblioteki do odkrywania wiedzy
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Laboratorium 3: Tworzenie modeli uczenia maszynowego
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab4-manipulacja-datasetem.html">
   Laboratorium 4: Manipulacje zbiorami danych
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab5-zarzadzanie-eksperymentami.html">
   Laboratorium 5: Narzędzia zarządzania eksperymentami
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab6-produktyzacja.html">
   Laboratorium 6: Produktyzacja procesów odkrywania wiedzy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab7-rozwiazywanie-problemu-1.html">
   Laboratorium 7: Rozwiązywanie problemu odkrywania wiedzy - część 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab8-rozwiazywanie-problemu-2.html">
   Laboratorium 7: Rozwiązywanie problemu odkrywania wiedzy - część 2
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  <br>Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/laboratoria/lab3-tworzenie-modeli.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/pwr-ai/przetwarzanie-danych-i-odkrywanie-wiedzy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/pwr-ai/przetwarzanie-danych-i-odkrywanie-wiedzy/issues/new?title=Issue%20on%20page%20%2Flaboratoria/lab3-tworzenie-modeli.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/pwr-ai/przetwarzanie-danych-i-odkrywanie-wiedzy/master?urlpath=tree/laboratoria/lab3-tworzenie-modeli.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#efekty-ksztalcenia-laboratorium">
   Efekty kształcenia laboratorium
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wprowadzenie">
   Wprowadzenie
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analiza-statystyczna-zbioru-treningowego">
   Analiza statystyczna zbioru treningowego
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#przykladowy-zbior-danych">
     Przykładowy zbiór danych
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pandas-profiling">
     Pandas Profiling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uczenie-maszynowe-przy-pomocy-sklearn">
   Uczenie maszynowe przy pomocy sklearn
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wczytanie-zbioru-danych">
     Wczytanie zbioru danych
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preprocessing-zbioru-danych">
     Preprocessing zbioru danych
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uczenie-modelu">
     Uczenie modelu
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#potoki">
     Potoki
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analiza-jakosci-modelu">
     Analiza jakości modelu
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sprawdzanie-krzyzowe">
     Sprawdzanie krzyżowe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dostosowywanie-parametrow">
     Dostosowywanie parametrów
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zadania">
   Zadania
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><img alt="" src="../_images/banner.png" /></p>
<div class="section" id="laboratorium-3-tworzenie-modeli-uczenia-maszynowego">
<h1>Laboratorium 3: Tworzenie modeli uczenia maszynowego<a class="headerlink" href="#laboratorium-3-tworzenie-modeli-uczenia-maszynowego" title="Permalink to this headline">¶</a></h1>
<div class="section" id="efekty-ksztalcenia-laboratorium">
<h2>Efekty kształcenia laboratorium<a class="headerlink" href="#efekty-ksztalcenia-laboratorium" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Podczas niniejszych zajęć:</p>
<ul class="simple">
<li><p>poznasz podstawowe pojęcia z zakresu uczenia maszynowego</p></li>
<li><p>dowiesz się jak przeprowadzić analizę statystyczną zbioru danych i na co zwrócić uwagę</p></li>
<li><p>poznasz i przeprowadzisz cały proces uczenia masznowego - od wczytania zbioru, poprzez jego transformacje, uczenie, aż po walidację krzyżową i dostrajanie parametrów modelu</p></li>
<li><p>poznasz podstawowe mechanizmy sprawdzania jakości modelu uczenia maszynowego</p></li>
</ul>
</div>
<div class="section" id="wprowadzenie">
<h2>Wprowadzenie<a class="headerlink" href="#wprowadzenie" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<ol class="simple">
<li><p>Uczenie maszynowe (ang. <em>machine learning</em>) jest obecnie najpopularniejszą dziedziną sztucznej inteligencji.</p></li>
<li><p>Polega ono na automatycznej budowie <em>modelu</em> poprzez ekspozycję <em>algorytmu</em> na <em>dane treningowe</em> w procesie zwanym <em>uczeniem</em>.</p></li>
<li><p>Model uczenia maszynowego posiada zdolność rozpoznawania wzorców wykrytych w danych, dzięki czemu jest w stanie dokonywać <em>predykcji</em>.</p></li>
<li><p>Celem uczenia maszynowego jest tworzenie modeli zdolnych do <em>generalizacji</em>, tj. poprawnego predykowania na danych nie użytych do treningu.</p></li>
</ol>
<p>W zależności od problemu który ma zostać rozwiązany, stosuje się różne metody i algorytmy, w szczególności:</p>
<ul class="simple">
<li><p>jeśli celem jest przypisanie danym pewnej kategorycznej etykiety, mówimy o <em>klasyfikacji</em> - np. określenie czy na zdjęciu jest kot, czy pies</p></li>
<li><p>jesli celem jest umiejscowienie danych na pewnej ciągłej skali liczbowej, mówimy o <em>regresji</em> - np. prognozowanie wartości produktu</p></li>
<li><p>jeśli celem jest zgrupowanie podobnych sobie danych, mówimy o <em>klasteryzacji</em> - np. przypisanie użytkowników Twittera do grup w zależności od poruszanych tematów</p></li>
</ul>
<p>Klasyfikacja i regresja są przykładami <em>uczenia nadzorowanego</em>, gdzie do treningu oprócz danych wejściowych opisujących problem, musimy też posiadać <em>etykietę</em>, tj. klasę lub wartość która ma być wyjściem modelu.</p>
<p>Klasteryzacja to przykład <em>uczenia nienadzorowanego</em>, gdzie model realizuje swoje zadanie bez dodatkowych informacji z naszej strony.</p>
<p><img alt="" src="../_images/rodzaje_uczenia.png" /></p>
</div>
<div class="section" id="analiza-statystyczna-zbioru-treningowego">
<h2>Analiza statystyczna zbioru treningowego<a class="headerlink" href="#analiza-statystyczna-zbioru-treningowego" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Przed rozpoczęciem rozwiązywania problemu przy użyciu metod uczenia maszynowego, w szczególności przed rozpoczęciem budowania modelu, konieczne jest sprawdzenie, z jakimi danymi przyszło się nam mierzyć.</p>
<p>Wśród podstawowych kwestii, które powinniśmy sprawdzić, są:</p>
<ul class="simple">
<li><p>ile mamy cech?</p></li>
<li><p>które spośród nich to cechy kategoryczne, a które numeryczne?</p></li>
<li><p>jakie wartości przyjmują poszczególne cechy?</p></li>
<li><p>czy wśród danych są brakujące wartości?</p></li>
<li><p>czy istnieje i jak wygląda etykieta? (w szczególności - czy mierzymy się z zadaniem klasyfikacji, regresji czy klasteryzacji?)</p></li>
<li><p>czy dane są zbalansowane względem danej wyjściowej?</p></li>
</ul>
<p>Dla małych i prostych zbiorów do nauki (tzw. <em>toy tasks</em>), zazwyczaj wystarczające jest ręczne przejrzenie pliku z danymi, by potrafić odpowiedzieć na w/w pytania. Niemniej przy bardziej ambitnych zadaniach, z pomocą przychodzą narzędzia automatyzujące pracę.</p>
<div class="section" id="przykladowy-zbior-danych">
<h3>Przykładowy zbiór danych<a class="headerlink" href="#przykladowy-zbior-danych" title="Permalink to this headline">¶</a></h3>
<p>Przeanalizujmy klasyczny zbiór danych dotyczący wina (opublikowany przez <code class="docutils literal notranslate"><span class="pre">Forina,</span> <span class="pre">M.</span> <span class="pre">et</span> <span class="pre">al,</span> <span class="pre">PARVUS</span> <span class="pre">-</span> <span class="pre">An</span> <span class="pre">Extendible</span> <span class="pre">Package</span> <span class="pre">for</span> <span class="pre">Data</span> <span class="pre">Exploration,</span> <span class="pre">Classification</span> <span class="pre">and</span> <span class="pre">Correlation.</span> <span class="pre">Institute</span> <span class="pre">of</span> <span class="pre">Pharmaceutical</span> <span class="pre">and</span> <span class="pre">Food</span> <span class="pre">Analysis</span> <span class="pre">and</span> <span class="pre">Technologies,</span> <span class="pre">Via</span> <span class="pre">Brigata</span> <span class="pre">Salerno,</span> <span class="pre">16147</span> <span class="pre">Genoa,</span> <span class="pre">Italy</span></code>, więcej informacji <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/wine">tutaj</a>)</p>
<p>Zbiór zawiera właściwości fizykochemiczne różnych próbek wina pobranych z jednego z regionów słonecznej Italii, jednakże pochodzących od trzech różnych plantatorów. Założeniem problemu jest określenie, który z nich jest wytwórcą danej próbki.</p>
<p>Zacznijmy od wczytania zbioru:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_wine</span>

<span class="n">dataset</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.23</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127.0</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.20</td>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100.0</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>0.26</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.16</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101.0</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.37</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113.0</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.24</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118.0</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Na pierwszy rzut oka możemy stwierdzić, że wszystkie kolumny są numeryczne, ale ich wartości różnią się dość znacząco.</p>
<p>Podstawowe informacje o statystykach zbioru danych możemy uzyskać przy wbudowanej w Pandas metodzie <code class="docutils literal notranslate"><span class="pre">describe()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
      <td>178.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>13.000618</td>
      <td>2.336348</td>
      <td>2.366517</td>
      <td>19.494944</td>
      <td>99.741573</td>
      <td>2.295112</td>
      <td>2.029270</td>
      <td>0.361854</td>
      <td>1.590899</td>
      <td>5.058090</td>
      <td>0.957449</td>
      <td>2.611685</td>
      <td>746.893258</td>
      <td>0.938202</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.811827</td>
      <td>1.117146</td>
      <td>0.274344</td>
      <td>3.339564</td>
      <td>14.282484</td>
      <td>0.625851</td>
      <td>0.998859</td>
      <td>0.124453</td>
      <td>0.572359</td>
      <td>2.318286</td>
      <td>0.228572</td>
      <td>0.709990</td>
      <td>314.907474</td>
      <td>0.775035</td>
    </tr>
    <tr>
      <th>min</th>
      <td>11.030000</td>
      <td>0.740000</td>
      <td>1.360000</td>
      <td>10.600000</td>
      <td>70.000000</td>
      <td>0.980000</td>
      <td>0.340000</td>
      <td>0.130000</td>
      <td>0.410000</td>
      <td>1.280000</td>
      <td>0.480000</td>
      <td>1.270000</td>
      <td>278.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>12.362500</td>
      <td>1.602500</td>
      <td>2.210000</td>
      <td>17.200000</td>
      <td>88.000000</td>
      <td>1.742500</td>
      <td>1.205000</td>
      <td>0.270000</td>
      <td>1.250000</td>
      <td>3.220000</td>
      <td>0.782500</td>
      <td>1.937500</td>
      <td>500.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>13.050000</td>
      <td>1.865000</td>
      <td>2.360000</td>
      <td>19.500000</td>
      <td>98.000000</td>
      <td>2.355000</td>
      <td>2.135000</td>
      <td>0.340000</td>
      <td>1.555000</td>
      <td>4.690000</td>
      <td>0.965000</td>
      <td>2.780000</td>
      <td>673.500000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>13.677500</td>
      <td>3.082500</td>
      <td>2.557500</td>
      <td>21.500000</td>
      <td>107.000000</td>
      <td>2.800000</td>
      <td>2.875000</td>
      <td>0.437500</td>
      <td>1.950000</td>
      <td>6.200000</td>
      <td>1.120000</td>
      <td>3.170000</td>
      <td>985.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>14.830000</td>
      <td>5.800000</td>
      <td>3.230000</td>
      <td>30.000000</td>
      <td>162.000000</td>
      <td>3.880000</td>
      <td>5.080000</td>
      <td>0.660000</td>
      <td>3.580000</td>
      <td>13.000000</td>
      <td>1.710000</td>
      <td>4.000000</td>
      <td>1680.000000</td>
      <td>2.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Jednakże w celu dokładniejszej analizy zbioru, posłużymy się biblioteką Pandas Profiling.</p>
</div>
<div class="section" id="pandas-profiling">
<h3>Pandas Profiling<a class="headerlink" href="#pandas-profiling" title="Permalink to this headline">¶</a></h3>
<p>Jest to biblioteka automatycznie analizująca zbiór danych i generujaca interaktywny raport. Alternatywnie, raport można zapisać w formacie <code class="docutils literal notranslate"><span class="pre">.html</span></code></p>
<p>Na dzień tworzenia tego zadania (2021.02.06) wersja 2.10 biblioteki zawiera błąd nie pozwalający generować raportu w środowisku Jupyter. Posłużymy się więc wersją 2.9, która działa poprawnie.</p>
<p>Upewnijmy się, że jest ona poprawnie zainstalowana:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install pandas-profiling<span class="o">==</span><span class="m">2</span>.9.0
</pre></div>
</div>
</div>
</div>
<p>Użycie biblioteki jest niezwykle proste:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas_profiling</span> <span class="kn">import</span> <span class="n">ProfileReport</span>

<span class="n">profile</span> <span class="o">=</span> <span class="n">ProfileReport</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">profile</span><span class="o">.</span><span class="n">to_widgets</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "f3d84f0e5143466690963c2ff4a8e289", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "a2508e2565d843c3b368316c203769c2", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "", "version_major": 2, "version_minor": 0}
</script><script type="application/vnd.jupyter.widget-view+json">
{"model_id": "651b34a55a514dc6a807af38aa9897ac", "version_major": 2, "version_minor": 0}
</script></div>
</div>
<p>Z raportu dowiadujemy się między innymi:</p>
<ul class="simple">
<li><p>mamy 13 kolumn numerycznych (dane wejściowe), jedną kategoryczną (etykieta) - będziemy więc zajmować się klasyfikacją</p></li>
<li><p>klasy są całkiem nieźle zbalansowane (39%, 33%, 27%)</p></li>
<li><p>nie mamy brakujących wartości ani duplikatów</p></li>
<li><p>możemy dokładnie przeanalizować statystyki poszczególnych cech, ich histogramy oraz wykresy zależności pomiędzy nimi</p></li>
</ul>
</div>
</div>
<div class="section" id="uczenie-maszynowe-przy-pomocy-sklearn">
<h2>Uczenie maszynowe przy pomocy sklearn<a class="headerlink" href="#uczenie-maszynowe-przy-pomocy-sklearn" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Scikit-learn (aka sklearn) jest aktualnie najpopularniejszą biblioteką w Pythonie pozwalającą kompleksowo przeprowadzać proces machine learningowy, który zazwyczaj składa się z następujących elementów:</p>
<ol class="simple">
<li><p>wczytanie zbioru danych</p></li>
<li><p>preprocessing zbioru:</p>
<ul class="simple">
<li><p>transformacje cech (normalizacja, skalowanie, kodowanie, dyskretyzacja, embeddowanie, ekstrakcja cech itd)</p></li>
<li><p>rozwiązanie kwestii brakujących i powtarzających się danych</p></li>
<li><p>rozwiązanie kwestii imbalansu klas (oversampling/undersampling)</p></li>
<li><p>augmentacja danych</p></li>
</ul>
</li>
<li><p>selekcja cech/redukcja wymiarowości</p></li>
<li><p>uczenie modelu</p></li>
<li><p>dostosowywanie (fine-tuning) parametrów</p></li>
</ol>
<p>Jednakże zanim pokrótce zapoznamy się z tymi metodami, upewnijmy się, że scikit-learn jest poprawnie zainstalowany:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install scikit-learn
</pre></div>
</div>
</div>
</div>
<div class="section" id="wczytanie-zbioru-danych">
<h3>Wczytanie zbioru danych<a class="headerlink" href="#wczytanie-zbioru-danych" title="Permalink to this headline">¶</a></h3>
<p>Scikit-learn posiada wbudowany zestaw standardowych, benchmarkowych zbiorów danych - jak np. używany w przykładzie zbiór <em>wine</em>. Pozwala także w prosty sposób generować syntetyczne dane.</p>
<p>Więcej informacji o dostępnych w bibliotece zbiorach danych <a class="reference external" href="https://scikit-learn.org/stable/datasets.html">tutaj</a></p>
<p>W przypadku rzeczywistych problemów i własnych datasetów - będziemy jednak używać biblioteki Pandas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># użyty już przykład wczytania datasetu wine, dla przypomnienia</span>

<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_wine</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">(</span><span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.23</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127.0</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.20</td>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100.0</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>0.26</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.16</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101.0</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.37</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113.0</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.24</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118.0</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Trzymając się przyjętej konwencji matematycznej, zbiór danych wejściowych nazywamy <code class="docutils literal notranslate"><span class="pre">X</span></code>, natomiast wyjściowych - <code class="docutils literal notranslate"><span class="pre">y</span></code></p>
</div>
<div class="section" id="preprocessing-zbioru-danych">
<h3>Preprocessing zbioru danych<a class="headerlink" href="#preprocessing-zbioru-danych" title="Permalink to this headline">¶</a></h3>
<p>Odpowiednie przygotowanie danych uczących jest kluczem do sukcesu każdego przedsięwzięcia machine learningu - w myśl zasady <code class="docutils literal notranslate"><span class="pre">Garbage</span> <span class="pre">in,</span> <span class="pre">garbage</span> <span class="pre">out</span></code>. Przed przystąpieniem do uczenia, zazwyczaj konieczne jest wykonanie co najmniej kilku kroków wstępnego przetwarzania danych.</p>
<p>Krok ten silnie uzależniony jest od samych danych - inaczej przygotowywać będziemy dane tekstowe, numeryczne, dźwiękowe czy obrazy. Dużą rolę gra tutaj także planowany do użycia algorytm - część z nich wymaga np. ustandaryzowanych danych (tj. pochodzących z rozkładu zbliżonego do normalnego, posiadających średnia w 0 i odchylenie standardowe równe 1).</p>
<p>Duże znaczenie dla jakości procesu ma balans klas - w przypadku danych niezbalansowanych, część algorytmów wykazuje tendencje do preferowania klasy nadreprezentowanej, przez co popełniają błędy.</p>
<p>Ponadto w wielu zbiorach danych występują cechy, które nie są informacyjne. Usunięcie takich cech często pozwala na poprawę jakości predykcji. Ograniczenie ilości cech ułatwia także technicznie proces uczenia - algorytm musi przetworzyc mniej danych, wiec dzieje się to szybciej. Istnieje wiele metod selekcji cech, np. bazujacych na testach statystycznych. Ich ogólna idea polega na ocenieniu cech wg. zadanej miary jakości, a następnie wyboru najbardziej wartościowych.</p>
<p>Alternatywnie stosuje się metody redukcji wymiarowości. W przeciwieństwie do selekcji cech, która jedynie wybiera spośród istniejących już danych pewien ich podzbiór, algorytmy redukcji wymiarowości przekształcają dane, tworząc nowe, bardziej informacyjne cechy. Najpopularniejszą metodą redukcji wymiarowości jest <code class="docutils literal notranslate"><span class="pre">PCA</span></code></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Preprocessingowi poświęcone zostało Laboratorium 4, gdzie w/w mechanizmy zostaną omówione dokładniej.</p>
</div>
<p>W naszym komfortowym przykładzie nie ma dużej potrzeby dostosowywania danych:</p>
<ul class="simple">
<li><p>klasy są w miarę dobrze zbalansowane</p></li>
<li><p>nie ma wartości brakujących</p></li>
<li><p>nie ma duplikatów</p></li>
<li><p>nie ma danych kategorycznych, poza etykietą, więc nie ma potrzeby ich kodowania</p></li>
</ul>
<p>Operujemy natomiast na danych numerycznych, które mają skrajnie różne wartości pomiędzy cechami, poddamy je więc standaryzacji</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># najpierw przekształćmy dataset do formatu numpy, akceptowalnego przez scikit-learn</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># zdefiniujmy funkcję wyświetlajacą statystyki średniej i odchylenia standardowego</span>
<span class="k">def</span> <span class="nf">print_dataset_stats</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Średnia cech:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Odchylenie standardowe cech:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Większość algorytmów i klas zawartych w scikit-learn implementuje interfejs fit/transform - tj. przy pomocy funkcji <code class="docutils literal notranslate"><span class="pre">fit</span></code> dokonywane jest dopasowywanie algorytmów do danych uczących (uczenie/ustalanie parametrów modelu), natomiast przy pomocy funkcji <code class="docutils literal notranslate"><span class="pre">transform</span></code> dokonywane jest przekształcenie danych.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Przed standaryzacją&quot;</span><span class="p">)</span>
<span class="n">print_dataset_stats</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Po standaryzacji&quot;</span><span class="p">)</span>
<span class="n">print_dataset_stats</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Przed standaryzacją
Średnia cech:
 [1.30006180e+01 2.33634831e+00 2.36651685e+00 1.94949438e+01
 9.97415730e+01 2.29511236e+00 2.02926966e+00 3.61853933e-01
 1.59089888e+00 5.05808988e+00 9.57449438e-01 2.61168539e+00
 7.46893258e+02]

Odchylenie standardowe cech:
 [8.09542915e-01 1.11400363e+00 2.73572294e-01 3.33016976e+00
 1.42423077e+01 6.24090564e-01 9.96048950e-01 1.24103260e-01
 5.70748849e-01 2.31176466e+00 2.27928607e-01 7.07993265e-01
 3.14021657e+02]

Po standaryzacji
Średnia cech:
 [-8.38280756e-16 -1.19754394e-16 -8.37033314e-16 -3.99181312e-17
 -3.99181312e-17  0.00000000e+00 -3.99181312e-16  3.59263181e-16
 -1.19754394e-16  2.49488320e-17  1.99590656e-16  3.19345050e-16
 -1.59672525e-16]

Odchylenie standardowe cech:
 [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="uczenie-modelu">
<h3>Uczenie modelu<a class="headerlink" href="#uczenie-modelu" title="Permalink to this headline">¶</a></h3>
<p>Mając odpowiednio przygotowane dane, możemy przystąpić do procesu uczenia. Pierwszym krokiem będzie podział zbioru na część treningową (na której nauczymy model) oraz testową (na której przetestujemy jego jakość). Taki podział pozwala zmierzyć zdolność modelu do generalizacji - sprawdzamy jakość na danych, które nie były użyte do nauki, których “model wcześniej nie widział”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_train: &#39;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;X_test: &#39;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y_train: &#39;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;y_test: &#39;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X_train:  (142, 13)
X_test:  (36, 13)
y_train:  (142,)
y_test:  (36,)
</pre></div>
</div>
</div>
</div>
<p>Finalnie jesteśmy gotowi stworzyć klasyfikator. Dla przykładu użyjemy algorytmu SVM. Przykłady innych modeli można znaleźć <a class="reference external" href="https://scikit-learn.org/stable/supervised_learning.html">tutaj</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">()</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVC()
</pre></div>
</div>
</div>
</div>
<p>Możemy go teraz użyć w celu predykcji nowych wartości:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 2])
</pre></div>
</div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Istnieje wiele modeli uczenia maszynowego. Wybór odpowiedniego zależy od problemu który rozwiązujemy, danych które posiadamy, pożądanemu rezultatowi i warunkom działania (np. pożądana szybkość uczenia i inferencji).</p>
<p>Do najpopularniejszych modeli nadzorowanych należą - drzewa decyzyjne (i lasy losowe), kNN, SVM, Naive Bayes, sieci neuronowe.</p>
<p>Niestety, dokładne wprowadzenie w fascynującą dziedzinę modelu uczenia maszynowego leży poza zakresem tego laboratorium.</p>
</div>
</div>
<div class="section" id="potoki">
<h3>Potoki<a class="headerlink" href="#potoki" title="Permalink to this headline">¶</a></h3>
<p>W powyższym przykładzie po wczytaniu danych przetworzyliśmy je przez dwa algorytmy - <code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code> i <code class="docutils literal notranslate"><span class="pre">SVM</span></code>. W przypadku bardziej rozbudowanego preprocessingu, niezwykle przydatna staje się możliwość łączenia wszystkich użytych mechanizmów w jeden potok:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="n">pipeline_classifier</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
    <span class="n">StandardScaler</span><span class="p">(),</span> 
    <span class="n">SVC</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">pipeline_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pipeline(steps=[(&#39;standardscaler&#39;, StandardScaler()), (&#39;svc&#39;, SVC())])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analiza-jakosci-modelu">
<h3>Analiza jakości modelu<a class="headerlink" href="#analiza-jakosci-modelu" title="Permalink to this headline">¶</a></h3>
<p>Na tym etapie posiadamy zbiór danych podzielony na część treningową i testową, oraz klasyfikator nauczony na częsci treningowej. Jak sprawdzić, jak dobrze jest on nauczony?</p>
<p>Do określenia jakości modelu służy szereg metryk, różnych w zależności od problemu.</p>
<p>W zadaniu klasyfikacji, standardowo używa się następujących miar wywodzących się z klasyfikacji binarnej:</p>
<ul class="simple">
<li><p>accuracy, oznaczająca procent poprawnie oznaczonych przykładów</p></li>
<li><p>F1 - będąca średnią miar <code class="docutils literal notranslate"><span class="pre">precision</span></code> i <code class="docutils literal notranslate"><span class="pre">recall</span></code>, mierzących skłonności modelu do niepopełniania błędów</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">y_predicted</span> <span class="o">=</span> <span class="n">pipeline_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: &#39;</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F1: &#39;</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;macro&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy:  0.9722222222222222
F1:  0.9747545582047685
</pre></div>
</div>
</div>
</div>
<p>Dokładniejsze informacje o jakości klasyfikacji możemy uzyskac np. przy pomocy metody <code class="docutils literal notranslate"><span class="pre">classification_report</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

<span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_predicted</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;0&#39;: {&#39;precision&#39;: 1.0,
  &#39;recall&#39;: 0.9166666666666666,
  &#39;f1-score&#39;: 0.9565217391304348,
  &#39;support&#39;: 12},
 &#39;1&#39;: {&#39;precision&#39;: 0.9375,
  &#39;recall&#39;: 1.0,
  &#39;f1-score&#39;: 0.967741935483871,
  &#39;support&#39;: 15},
 &#39;2&#39;: {&#39;precision&#39;: 1.0, &#39;recall&#39;: 1.0, &#39;f1-score&#39;: 1.0, &#39;support&#39;: 9},
 &#39;accuracy&#39;: 0.9722222222222222,
 &#39;macro avg&#39;: {&#39;precision&#39;: 0.9791666666666666,
  &#39;recall&#39;: 0.9722222222222222,
  &#39;f1-score&#39;: 0.9747545582047685,
  &#39;support&#39;: 36},
 &#39;weighted avg&#39;: {&#39;precision&#39;: 0.9739583333333334,
  &#39;recall&#39;: 0.9722222222222222,
  &#39;f1-score&#39;: 0.9720663861617579,
  &#39;support&#39;: 36}}
</pre></div>
</div>
</div>
</div>
<p>W przypadku zadania regresji, standardowo używaną miarą jest błąd średniokwadratowy (<code class="docutils literal notranslate"><span class="pre">ang.</span> <span class="pre">mean</span> <span class="pre">square</span> <span class="pre">error</span></code>). Więcej informacji o różnych rodzajach metryk jakości modelu - <a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics">tutaj</a></p>
</div>
<div class="section" id="sprawdzanie-krzyzowe">
<h3>Sprawdzanie krzyżowe<a class="headerlink" href="#sprawdzanie-krzyzowe" title="Permalink to this headline">¶</a></h3>
<p>Powyżej nauczyliśmy model klasyfikować - i to z bardzo dobrą jakością!</p>
<p>Jednakże, nauczyliśmy nasz model na pewnym podzbiorze danych i przetestowaliśmy na innym. Nie mamy pewności, czy model sam w sobie wykazuje się dobrą jakością, czy to akurat ten specyficzny wybór podzbiorów danych daje tak dobre wyniki.</p>
<p>Z pomocą przychodzi tutaj <code class="docutils literal notranslate"><span class="pre">sprawdzanie</span> <span class="pre">krzyżowe</span></code> <code class="docutils literal notranslate"><span class="pre">(ang.</span> <span class="pre">cross-validation)</span></code>. Jest to procedura polegająca na kilkukrotnym uruchomieniu procedury uczenia modelu, za każdym razem na innym podzbiorze danych. Uśredniony wynik takich kilku modeli pozwala z większą dokładnością wyrokować o jakości samego modelu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span>
    <span class="n">pipeline_classifier</span><span class="p">,</span> 
    <span class="n">X</span><span class="p">,</span> 
    <span class="n">y</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;f1_macro&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cv_results</span><span class="p">[</span><span class="s1">&#39;test_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.983504493924021
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dostosowywanie-parametrow">
<h3>Dostosowywanie parametrów<a class="headerlink" href="#dostosowywanie-parametrow" title="Permalink to this headline">¶</a></h3>
<p>Praktycznie każdy z algorytmów uczenia maszynowego posiada pewne parametry (lub hiper-parametry), które wpływają na proces uczenia. W przypadku użytego algorytmu SVM są to np. rodzaj funkcji jądra i stopień regularyzacji.</p>
<p>Odpowiednie dostosowanie parametrów algorytmu do danego problemu może znacząco poprawić jakość jego działania.</p>
<p>Sklearn posiada zaimplementowanych kilka strategii poszukiwania najlepszych parametrów. Użyjemy tutaj najprostszego podejścia losowego:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">param_distributions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;svc__kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">],</span>
                       <span class="s1">&#39;svc__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>

<span class="c1"># now create a searchCV object and fit it to the data</span>
<span class="n">search</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">pipeline_classifier</span><span class="p">,</span>
                            <span class="n">n_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                            <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_distributions</span><span class="p">)</span>
<span class="n">search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;svc__kernel&#39;: &#39;linear&#39;, &#39;svc__C&#39;: 0.1}
</pre></div>
</div>
</div>
</div>
<p>Mechanizm wykonuje ilosc powtórzeń zadaną przez argument <code class="docutils literal notranslate"><span class="pre">n_iter</span></code> i losuje za każdym razem wartości parametrów spośród podanych. Dla każdego z nich wykonuje cross-walidację. Możemy też przeanalizować dokładne wyniki tego procesu:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">search</span><span class="o">.</span><span class="n">cv_results_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mean_fit_time&#39;: array([0.00537829, 0.00644789, 0.00556135, 0.00395641, 0.00475116]),
 &#39;std_fit_time&#39;: array([0.00302507, 0.00417539, 0.00360711, 0.0018147 , 0.00253776]),
 &#39;mean_score_time&#39;: array([0.00384507, 0.00235186, 0.00214186, 0.00119901, 0.00100121]),
 &#39;std_score_time&#39;: array([0.00432281, 0.00146971, 0.00099259, 0.00075927, 0.00032661]),
 &#39;param_svc__kernel&#39;: masked_array(data=[&#39;rbf&#39;, &#39;linear&#39;, &#39;linear&#39;, &#39;linear&#39;, &#39;poly&#39;],
              mask=[False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;param_svc__C&#39;: masked_array(data=[0.1, 2, 0.1, 4, 2],
              mask=[False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;params&#39;: [{&#39;svc__kernel&#39;: &#39;rbf&#39;, &#39;svc__C&#39;: 0.1},
  {&#39;svc__kernel&#39;: &#39;linear&#39;, &#39;svc__C&#39;: 2},
  {&#39;svc__kernel&#39;: &#39;linear&#39;, &#39;svc__C&#39;: 0.1},
  {&#39;svc__kernel&#39;: &#39;linear&#39;, &#39;svc__C&#39;: 4},
  {&#39;svc__kernel&#39;: &#39;poly&#39;, &#39;svc__C&#39;: 2}],
 &#39;split0_test_score&#39;: array([0.97222222, 0.94444444, 0.97222222, 0.94444444, 0.91666667]),
 &#39;split1_test_score&#39;: array([0.97222222, 0.97222222, 0.94444444, 0.97222222, 0.97222222]),
 &#39;split2_test_score&#39;: array([0.94444444, 0.97222222, 0.97222222, 0.97222222, 1.        ]),
 &#39;split3_test_score&#39;: array([0.94285714, 0.97142857, 1.        , 0.97142857, 0.94285714]),
 &#39;split4_test_score&#39;: array([1.        , 0.97142857, 0.97142857, 0.97142857, 0.97142857]),
 &#39;mean_test_score&#39;: array([0.96634921, 0.96634921, 0.97206349, 0.96634921, 0.96063492]),
 &#39;std_test_score&#39;: array([0.02113318, 0.01095813, 0.01757108, 0.01095813, 0.02845922]),
 &#39;rank_test_score&#39;: array([2, 2, 1, 2, 5], dtype=int32)}
</pre></div>
</div>
</div>
</div>
<p>Parametry modelu sprawdzić możemy przy pomocy metody <code class="docutils literal notranslate"><span class="pre">get_params()</span></code> lub <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC">w dokumentacji</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipeline_classifier</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;memory&#39;: None,
 &#39;steps&#39;: [(&#39;standardscaler&#39;, StandardScaler()), (&#39;svc&#39;, SVC())],
 &#39;verbose&#39;: False,
 &#39;standardscaler&#39;: StandardScaler(),
 &#39;svc&#39;: SVC(),
 &#39;standardscaler__copy&#39;: True,
 &#39;standardscaler__with_mean&#39;: True,
 &#39;standardscaler__with_std&#39;: True,
 &#39;svc__C&#39;: 1.0,
 &#39;svc__break_ties&#39;: False,
 &#39;svc__cache_size&#39;: 200,
 &#39;svc__class_weight&#39;: None,
 &#39;svc__coef0&#39;: 0.0,
 &#39;svc__decision_function_shape&#39;: &#39;ovr&#39;,
 &#39;svc__degree&#39;: 3,
 &#39;svc__gamma&#39;: &#39;scale&#39;,
 &#39;svc__kernel&#39;: &#39;rbf&#39;,
 &#39;svc__max_iter&#39;: -1,
 &#39;svc__probability&#39;: False,
 &#39;svc__random_state&#39;: None,
 &#39;svc__shrinking&#39;: True,
 &#39;svc__tol&#39;: 0.001,
 &#39;svc__verbose&#39;: False}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="zadania">
<h2>Zadania<a class="headerlink" href="#zadania" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>1. (1 pkt) Przy pomocy sklearn, wczytaj zbiór danych <a class="reference external" href="https://scikit-learn.org/stable/datasets/real_world.html#california-housing-dataset">California Housing</a> i wyświetl jego przykładowe kilka rekordów</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#TUTAJ UMIEŚĆ KOD</span>
</pre></div>
</div>
</div>
</div>
<p>2. (1.5 pkt) Przy pomocy biblioteki Pandas Profiling przeanalizuj w/w zbiór i odpowiedz na następujące pytania:</p>
<ul class="simple">
<li><p>ile znajduje się w zbiorze cech kategorycznych, a ile numerycznych?</p></li>
<li><p>czy zmienna wyjściowa jest kategoryczna, czy numeryczna?</p></li>
<li><p>czy rozpatrujemy problem klasyfikacji, klasteryzacji czy regresji?</p></li>
<li><p>ile w zbiorze jest brakujących wartości?</p></li>
<li><p>czy któraś z cech koreluje ze zmienną wyjściową? Jeśli tak - która?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TUTAJ UMIEŚC ODPOWIEDZI</span>
</pre></div>
</div>
</div>
</div>
<p>3. (2 pkt) stwórz pipeline składający się z modułu standaryzacji i estymatora - w zależności czy problem dotyczy klasyfikacji czy regresji, użyj <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">RandomForestClassifier</a> lub <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">RandomForestRegressor</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TUTAJ UMIEŚĆ KOD</span>
</pre></div>
</div>
</div>
</div>
<p>4. (4 pkt) używając sprawdzianu krzyżowego z 10 foldami (sprawdź odpowiedni parametr w <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html">dokumentacji</a>) sprawdź jakość predykcji, używając odpowiednich do zadania metryk (wybierz odpowiednią spośród tych <a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics">tutaj</a>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TUTAJ UMIEŚĆ KOD</span>
</pre></div>
</div>
</div>
</div>
<p>5. (3 pkt) Używając cross-walidacji, porównaj jakość modelu używającego i nieużywającego standaryzacji cech.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TUTAJ UMIEŚC KOD</span>
</pre></div>
</div>
</div>
</div>
<p>6. (3.5 pkt) Używając metody <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">GridSearch</a> sprawdź, jakie parametry modelu najlepiej pasują do rozwiązywanego problemu</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Pamiętaj, że mechanizm GridSearch przeszukuje wszystkie możliwe kombinacje podanych parametrów. Nie podawaj ich zbyt wiele, by skończyć zadanie w sensownym czasie.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TUTAJ UMIEŚĆ KOD</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./laboratoria"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="lab2-podstawowe-biblioteki.html" title="previous page">Laboratorium 2: Podstawowe biblioteki do odkrywania wiedzy</a>
    <a class='right-next' id="next-link" href="lab4-manipulacja-datasetem.html" title="next page">Laboratorium 4: Manipulacje zbiorami danych</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tomasz Kajdanowicz, Kamil Tagowski, Krzysztof Rajda<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>